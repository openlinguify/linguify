{% load i18n %}
<!-- Public deck details -->
<div class="deck-details-content">
    <div class="deck-header-info">
        <div class="deck-title-section">
            <h4 class="deck-name">{{ deck.name }}</h4>
            <p class="deck-author">{% trans "By" %} <strong>{{ deck.user.username }}</strong></p>
        </div>
        
        <div class="deck-actions-section">
            <div class="deck-stats-badges">
                <span class="badge badge-info">{{ total_cards }} {% trans "cards" %}</span>
                <span class="badge badge-success">{{ total_sessions }} {% trans "users" %}</span>
                {% if deck.avg_rating %}
                <span class="badge badge-warning">
                    <i class="bi bi-star-fill"></i> {{ deck.avg_rating|floatformat:1 }}
                </span>
                {% endif %}
            </div>
            
            {% if can_import %}
            <button class="btn-linguify"
                    hx-post="{% url 'revision_web:explore_import_deck' deck.id %}"
                    hx-swap="none"
                    hx-confirm="{% trans 'Do you want to import this deck into your collection?' %}">
                <i class="bi bi-download me-2"></i>
                {% trans "Import this deck" %}
            </button>
            {% endif %}
        </div>
    </div>
    
    <div class="deck-body-info">
        <div class="row">
            <div class="col-md-8">
                <!-- Description -->
                {% if deck.description %}
                <div class="deck-description mb-4">
                    <h6><i class="bi bi-info-circle me-2"></i>{% trans "Description" %}</h6>
                    <p class="text-muted">{{ deck.description }}</p>
                </div>
                {% endif %}
                
                <!-- Aperçu des cartes -->
                <div class="cards-preview">
                    <h6><i class="bi bi-card-list me-2"></i>{% trans "Cards preview" %} ({{ cards|length }}/{{ total_cards }})</h6>
                    
                    <div class="cards-preview-grid">
                        {% for card in cards %}
                        <div class="card-preview-item">
                            <div class="card-preview-question">
                                <strong>Q:</strong> {{ card.question|truncatechars:100 }}
                            </div>
                            <div class="card-preview-answer">
                                <strong>R:</strong> {{ card.answer|truncatechars:100 }}
                            </div>
                            {% if card.category %}
                            <div class="card-preview-category">
                                <span class="badge badge-outline">{{ card.category }}</span>
                            </div>
                            {% endif %}
                        </div>
                        {% empty %}
                        <div class="empty-cards">
                            <p class="text-muted">{% trans "This deck contains no visible cards." %}</p>
                        </div>
                        {% endfor %}
                    </div>
                    
                    {% if total_cards > cards|length %}
                    <div class="text-center mt-3">
                        <small class="text-muted">
                            {% trans "And" %} {{ total_cards|add:cards|length|add:-1 }} {% trans "more cards..." %}
                        </small>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <div class="col-md-4">
                <!-- Informations détaillées -->
                <div class="deck-metadata">
                    <h6><i class="bi bi-info-square me-2"></i>{% trans "Information" %}</h6>
                    
                    <div class="metadata-list">
                        <div class="metadata-item">
                            <span class="label">{% trans "Created:" %}</span>
                            <span class="value">{{ deck.created_at|date:"d/m/Y à H:i" }}</span>
                        </div>
                        
                        <div class="metadata-item">
                            <span class="label">{% trans "Modified:" %}</span>
                            <span class="value">{{ deck.updated_at|date:"d/m/Y à H:i" }}</span>
                        </div>
                        
                        {% if deck.category %}
                        <div class="metadata-item">
                            <span class="label">{% trans "Category:" %}</span>
                            <span class="value">{{ deck.category|title }}</span>
                        </div>
                        {% endif %}
                        
                        {% if deck.language %}
                        <div class="metadata-item">
                            <span class="label">{% trans "Language:" %}</span>
                            <span class="value">{{ deck.language|upper }}</span>
                        </div>
                        {% endif %}
                        
                        {% if deck.level %}
                        <div class="metadata-item">
                            <span class="label">{% trans "Level:" %}</span>
                            <span class="value">{{ deck.level|title }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Actions supplémentaires -->
                {% if can_import %}
                <div class="additional-actions mt-4">
                    <h6><i class="bi bi-gear me-2"></i>{% trans "Actions" %}</h6>
                    
                    <div class="action-buttons-list">
                        <button class="action-btn-full favorite-btn"
                                hx-post="{% url 'revision_web:explore_toggle_favorite' deck.id %}"
                                hx-swap="outerHTML">
                            <i class="bi bi-heart me-2"></i>
                            {% trans "Add to favorites" %}
                        </button>
                        
                        <button class="action-btn-full collection-btn"
                                hx-get="{% url 'revision_web:explore_add_to_collection' deck.id %}"
                                hx-target="#collectionModal .modal-body"
                                data-bs-toggle="modal" 
                                data-bs-target="#collectionModal">
                            <i class="bi bi-collection me-2"></i>
                            {% trans "Add to collection" %}
                        </button>
                        
                        <button class="action-btn-full share-btn">
                            <i class="bi bi-share me-2"></i>
                            {% trans "Share this deck" %}
                        </button>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
.deck-details-content {
    padding: 1rem;
}

.deck-header-info {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #eee;
}

.deck-name {
    color: #2c3e50;
    margin-bottom: 0.5rem;
}

.deck-author {
    color: #6c757d;
    margin: 0;
}

.deck-stats-badges .badge {
    margin-right: 0.5rem;
}

.cards-preview-grid {
    display: grid;
    gap: 1rem;
    margin-top: 1rem;
}

.card-preview-item {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
}

.card-preview-question, .card-preview-answer {
    margin-bottom: 0.5rem;
}

.card-preview-category {
    text-align: right;
}

.metadata-list {
    display: grid;
    gap: 0.75rem;
}

.metadata-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #f0f0f0;
}

.metadata-item .label {
    font-weight: 500;
    color: #6c757d;
}

.metadata-item .value {
    color: #2c3e50;
}

.action-buttons-list {
    display: grid;
    gap: 0.5rem;
}

.action-btn-full {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 1px solid #dee2e6;
    background: white;
    border-radius: 6px;
    display: flex;
    align-items: center;
    text-decoration: none;
    color: #2c3e50;
    transition: all 0.2s;
}

.action-btn-full:hover {
    background: #f8f9fa;
    border-color: #adb5bd;
    color: #495057;
}

.empty-cards {
    text-align: center;
    padding: 2rem;
    color: #6c757d;
}
</style>