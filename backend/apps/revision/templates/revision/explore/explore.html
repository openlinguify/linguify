{% extends "revision/base_new.html" %}
{% load static %}

{% block page_title %}Explorer{% endblock %}

{% block header_content %}
{% include 'revision/components/navbar.html' %}
{% endblock %}

{% block content %}
<div class="flex" style="height: 100%; min-height: 100%;">
    <!-- Sidebar pour les filtres avancés - Interface améliorée avec layout Liste de cartes -->
    <div id="exploreSidebar" class="sidebar-linguify show">
        <div class="sidebar-content">
        <!-- Header avec toggle moderne -->
        <div class="sidebar-modern-header">
            <div class="header-title-group">
                <div class="sidebar-icon-primary">
                    <i class="bi bi-funnel-fill"></i>
                </div>
                <div>
                    <h6 class="sidebar-title">Filtres intelligents</h6>
                    <small class="sidebar-subtitle">Affinez votre recherche</small>
                </div>
            </div>
            <button class="sidebar-collapse-btn" id="collapseSidebar" title="Réduire">
                <i class="bi bi-chevron-left"></i>
            </button>
        </div>
        
        <!-- Filtres rapides en chips -->
        <div class="quick-filters-section">
            <div class="quick-filters-grid">
                <div class="filter-chip active" data-category="all">
                    <i class="bi bi-grid-3x3-gap-fill"></i>
                    <span>Tout</span>
                </div>
                <div class="filter-chip" data-category="languages">
                    <i class="bi bi-globe2"></i>
                    <span>Langues</span>
                </div>
                <div class="filter-chip" data-category="science">
                    <i class="bi bi-microscope"></i>
                    <span>Sciences</span>
                </div>
                <div class="filter-chip" data-category="technology">
                    <i class="bi bi-cpu"></i>
                    <span>Tech</span>
                </div>
            </div>
        </div>

        <!-- Section Filtres avancés - Collapsible -->
        <div class="filter-section" data-section="advanced">
            <div class="section-header" data-toggle="advanced">
                <div class="section-title">
                    <i class="bi bi-sliders"></i>
                    <span>Filtres avancés</span>
                </div>
                <i class="bi bi-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="advancedFilters">
                <!-- Filtre par catégorie -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-folder2"></i>
                        Domaine d'études
                    </label>
                    <div class="custom-select-wrapper">
                        <select id="categoryFilter" class="modern-select">
                            <option value="">Tous les domaines</option>
                            <option value="languages">🌍 Langues étrangères</option>
                            <option value="science">🧬 Sciences & Recherche</option>
                            <option value="history">📜 Histoire & Géographie</option>
                            <option value="math">📐 Mathématiques</option>
                            <option value="literature">📚 Littérature & Arts</option>
                            <option value="medicine">⚕️ Médecine & Santé</option>
                            <option value="technology">💻 Informatique & Tech</option>
                            <option value="business">💼 Économie & Business</option>
                            <option value="other">📋 Autre</option>
                        </select>
                        <i class="bi bi-chevron-down select-icon"></i>
                    </div>
                </div>

                <!-- Filtre par langue -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-translate"></i>
                        Langue du contenu
                    </label>
                    <div class="language-filter-grid">
                        <button class="language-option active" data-lang="all">
                            <span class="lang-flag">🌐</span>
                            <span class="lang-name">Toutes</span>
                        </button>
                        <button class="language-option" data-lang="fr">
                            <span class="lang-flag">🇫🇷</span>
                            <span class="lang-name">FR</span>
                        </button>
                        <button class="language-option" data-lang="en">
                            <span class="lang-flag">🇺🇸</span>
                            <span class="lang-name">EN</span>
                        </button>
                        <button class="language-option" data-lang="es">
                            <span class="lang-flag">🇪🇸</span>
                            <span class="lang-name">ES</span>
                        </button>
                        <button class="language-option" data-lang="de">
                            <span class="lang-flag">🇩🇪</span>
                            <span class="lang-name">DE</span>
                        </button>
                        <button class="language-option" data-lang="it">
                            <span class="lang-flag">🇮🇹</span>
                            <span class="lang-name">IT</span>
                        </button>
                    </div>
                </div>

                <!-- Filtre par niveau avec slider visuel -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-speedometer2"></i>
                        Niveau de difficulté
                    </label>
                    <div class="level-selector">
                        <button class="level-btn active" data-level="all">
                            <div class="level-icon all-levels">📚</div>
                            <span>Tous</span>
                        </button>
                        <button class="level-btn" data-level="beginner">
                            <div class="level-icon beginner"></div>
                            <span>Débutant</span>
                        </button>
                        <button class="level-btn" data-level="intermediate">
                            <div class="level-icon intermediate"></div>
                            <span>Intermédiaire</span>
                        </button>
                        <button class="level-btn" data-level="advanced">
                            <div class="level-icon advanced"></div>
                            <span>Avancé</span>
                        </button>
                        <button class="level-btn" data-level="expert">
                            <div class="level-icon expert"></div>
                            <span>Expert</span>
                        </button>
                    </div>
                </div>
            
                <!-- Filtre par créateur -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-person-circle"></i>
                        Créateur
                    </label>
                    <div class="search-input-enhanced">
                        <i class="bi bi-search search-icon-small"></i>
                        <input type="text" id="authorFilter" class="modern-input" 
                               placeholder="Rechercher un créateur...">
                        <button class="clear-input" style="display: none;">
                            <i class="bi bi-x-circle"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Filtre par taille du deck -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-stack"></i>
                        Nombre de cartes
                    </label>
                    <div class="range-selector">
                        <div class="range-inputs">
                            <input type="number" id="minCards" class="range-input" 
                                   placeholder="Min" min="1" value="">
                            <span class="range-separator">à</span>
                            <input type="number" id="maxCards" class="range-input" 
                                   placeholder="Max" min="1" value="">
                        </div>
                        <div class="range-presets">
                            <button class="preset-btn" data-range="1-20">Petit (1-20)</button>
                            <button class="preset-btn" data-range="21-50">Moyen (21-50)</button>
                            <button class="preset-btn" data-range="51+">Large (51+)</button>
                        </div>
                    </div>
                </div>

                <!-- Filtre par rating avec étoiles interactives -->
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="bi bi-star-fill"></i>
                        Note minimale
                    </label>
                    <div class="rating-selector">
                        <div class="star-rating-filter" id="ratingFilter">
                            <button class="star-btn active" data-rating="0" title="Toutes les notes">
                                <span class="star-text">Toutes</span>
                            </button>
                            <button class="star-btn" data-rating="1" title="1+ étoiles">
                                <i class="bi bi-star-fill"></i>
                            </button>
                            <button class="star-btn" data-rating="2" title="2+ étoiles">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </button>
                            <button class="star-btn" data-rating="3" title="3+ étoiles">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </button>
                            <button class="star-btn" data-rating="4" title="4+ étoiles">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </button>
                            <button class="star-btn" data-rating="5" title="5 étoiles uniquement">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </button>
                        </div>
                    </div>
                </div>
            
                <!-- Actions avec compteur de filtres -->
                <div class="filter-actions">
                    <div class="active-filters-count" id="activeFiltersCount" style="display: none;">
                        <span class="count-badge">3</span>
                        <span class="count-text">filtres actifs</span>
                    </div>
                    <div class="action-buttons">
                        <button id="clearFilters" class="clear-btn">
                            <i class="bi bi-arrow-counterclockwise"></i>
                            Réinitialiser
                        </button>
                        <button id="applyFilters" class="apply-btn">
                            <i class="bi bi-search"></i>
                            Rechercher
                            <div class="btn-loading" style="display: none;">
                                <div class="spinner"></div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Collections personnelles avec design moderne -->
        <div class="filter-section" data-section="collections">
            <div class="section-header" data-toggle="collections">
                <div class="section-title">
                    <i class="bi bi-collection-fill"></i>
                    <span>Mes Collections</span>
                    <div class="collection-count-badge" id="myCollectionsCount">0</div>
                </div>
                <i class="bi bi-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="collectionsContent">
                <div class="collection-actions">
                    <button class="create-collection-btn" id="createCollectionBtn">
                        <i class="bi bi-plus-circle"></i>
                        <span>Nouvelle collection</span>
                    </button>
                </div>
                <div id="myCollections" class="collections-list">
                    <!-- Collections vides par défaut -->
                    <div class="empty-collections">
                        <div class="empty-icon">
                            <i class="bi bi-collection"></i>
                        </div>
                        <p>Aucune collection créée</p>
                        <small>Organisez vos decks favoris en collections</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Favoris avec affichage amélioré -->
        <div class="filter-section" data-section="favorites">
            <div class="section-header" data-toggle="favorites">
                <div class="section-title">
                    <i class="bi bi-heart-fill"></i>
                    <span>Favoris</span>
                    <div class="favorites-count-badge" id="favoritesCount">0</div>
                </div>
                <i class="bi bi-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="favoritesContent">
                <div id="favoriteDecks" class="favorites-list">
                    <!-- Favoris vides par défaut -->
                    <div class="empty-favorites">
                        <div class="empty-icon">
                            <i class="bi bi-heart"></i>
                        </div>
                        <p>Aucun favori sauvegardé</p>
                        <small>Cliquez sur ❤️ pour ajouter des decks</small>
                    </div>
                </div>
                <div class="favorites-actions">
                    <button class="view-all-favorites" id="viewAllFavorites" style="display: none;">
                        <i class="bi bi-arrow-right"></i>
                        <span>Voir tous mes favoris</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Trending avec meilleur design -->
        <div class="filter-section" data-section="trending">
            <div class="section-header" data-toggle="trending">
                <div class="section-title">
                    <i class="bi bi-fire"></i>
                    <span>🔥 Tendances</span>
                    <div class="trending-badge">Semaine</div>
                </div>
                <i class="bi bi-chevron-down toggle-icon"></i>
            </div>
            <div class="section-content" id="trendingContent">
                <div class="trending-period-selector">
                    <button class="period-btn active" data-period="week">Semaine</button>
                    <button class="period-btn" data-period="month">Mois</button>
                    <button class="period-btn" data-period="all">All-time</button>
                </div>
                <div id="popularDecks" class="trending-list">
                    <!-- Exemple de trending deck avec design amélioré -->
                    <div class="trending-item">
                        <div class="trending-rank">1</div>
                        <div class="trending-content">
                            <div class="trending-title">Vocabulaire Anglais B2</div>
                            <div class="trending-meta">
                                <span class="trend-stat">
                                    <i class="bi bi-graph-up-arrow"></i>
                                    +47%
                                </span>
                                <span class="trend-stat">
                                    <i class="bi bi-eye"></i>
                                    1.2k vues
                                </span>
                            </div>
                        </div>
                        <div class="trending-indicator">
                            <i class="bi bi-arrow-up"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistiques communautaires modernisées -->
        <div class="community-stats-section">
            <div class="stats-header">
                <div class="stats-title">
                    <i class="bi bi-graph-up-arrow"></i>
                    <span>Statistiques globales</span>
                </div>
            </div>
            <div class="stats-grid-modern">
                <div class="stat-card">
                    <div class="stat-icon decks">
                        <i class="bi bi-stack"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="totalDecksCount">---</div>
                        <div class="stat-label">Decks publics</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon cards">
                        <i class="bi bi-card-text"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="totalCardsCount">---</div>
                        <div class="stat-label">Cartes totales</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon users">
                        <i class="bi bi-people"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="totalAuthorsCount">---</div>
                        <div class="stat-label">Créateurs actifs</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon activity">
                        <i class="bi bi-activity"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="weeklyActivity">---</div>
                        <div class="stat-label">Cette semaine</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- Zone principale avec la même structure que Liste de cartes -->
    <div class="flex-1 revision-study main-content-area" style="overflow-y: auto; height: 100%;">
    <!-- Vue d'accueil -->
    <div id="exploreWelcome" class="study-content">
        <div class="text-center p-5">
            <i class="bi bi-globe2 text-linguify-primary mb-4" style="font-size: 4rem;"></i>
            <h2 class="mb-3">Explorer les Decks Publics</h2>
            <p class="text-muted mb-4">
                Découvrez des milliers de decks de flashcards créés par la communauté Linguify.
                Trouvez le deck parfait pour vos besoins d'apprentissage !
            </p>
            
            <div class="row g-3 justify-content-center">
                <div class="col-md-4">
                    <div class="card-linguify h-100">
                        <div class="card-body text-center p-4">
                            <i class="bi bi-search text-linguify-primary mb-3" style="font-size: 2rem;"></i>
                            <h5 class="card-title text-linguify-primary">Recherche avancée</h5>
                            <p class="card-text small text-muted">
                                Trouvez des decks par sujet, langue, niveau de difficulté.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card-linguify h-100">
                        <div class="card-body text-center p-4">
                            <i class="bi bi-download text-linguify-accent mb-3" style="font-size: 2rem;"></i>
                            <h5 class="card-title text-linguify-accent">Import facile</h5>
                            <p class="card-text small text-muted">
                                Importez instantanément des decks publics dans votre collection.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card-linguify h-100">
                        <div class="card-body text-center p-4">
                            <i class="bi bi-people text-linguify-secondary mb-3" style="font-size: 2rem;"></i>
                            <h5 class="card-title text-linguify-secondary">Communauté</h5>
                            <p class="card-text small text-muted">
                                Découvrez du contenu créé par des apprenants passionnés.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="startExploring" class="btn-linguify btn-lg mt-4">
                <i class="bi bi-rocket me-2"></i>
                Commencer l'exploration
            </button>
        </div>
    </div>
    
    <!-- Résultats de recherche -->
    <div id="exploreResults" style="display: none;">
        <!-- Advanced Search Bar - Interface modernisée -->
        <div class="modern-search-container">
            <div class="search-header-enhanced">
                <div class="search-title-group">
                    <h4 class="search-title">Découvrez des milliers de decks</h4>
                    <p class="search-subtitle">Plus de <span class="highlight-number" id="totalDecksDisplay">---</span> decks créés par la communauté</p>
                </div>
                <div class="view-mode-selector">
                    <button class="view-mode-btn active" data-view="grid" title="Vue grille">
                        <i class="bi bi-grid-3x3-gap"></i>
                    </button>
                    <button class="view-mode-btn" data-view="list" title="Vue liste">
                        <i class="bi bi-list-ul"></i>
                    </button>
                    <button class="view-mode-btn" data-view="compact" title="Vue compacte">
                        <i class="bi bi-layout-three-columns"></i>
                    </button>
                </div>
            </div>
            
            <div class="search-input-wrapper-enhanced">
                <div class="search-main-container">
                    <div class="search-input-group-modern">
                        <div class="search-icon-container">
                            <i class="bi bi-search search-icon-main"></i>
                        </div>
                        <input type="text" id="exploreSearchInput" class="search-input-modern" 
                               placeholder="Rechercher par titre, sujet, créateur..." 
                               autocomplete="off">
                        <div class="search-actions-modern">
                            <button id="voiceSearchBtn" class="search-action-btn voice-search" title="Recherche vocale">
                                <i class="bi bi-mic"></i>
                                <span class="action-text">Vocal</span>
                            </button>
                            <button id="aiSearchBtn" class="search-action-btn ai-search" title="Recherche intelligente">
                                <i class="bi bi-stars"></i>
                                <span class="action-text">IA</span>
                            </button>
                            <button id="advancedSearchToggle" class="search-action-btn advanced-toggle" title="Options avancées">
                                <i class="bi bi-sliders"></i>
                                <span class="action-text">Filtres</span>
                            </button>
                        </div>
                    </div>
                    <div class="search-secondary-actions">
                        <button id="sidebarToggle" class="secondary-action-btn sidebar-toggle" title="Panneau latéral">
                            <i class="bi bi-layout-sidebar"></i>
                            <span>Panneau</span>
                        </button>
                        <button id="notificationBtn" class="secondary-action-btn notification-toggle" title="Notifications">
                            <i class="bi bi-bell"></i>
                            <span class="notification-badge-modern" id="notificationBadge">3</span>
                        </button>
                        <button id="savedSearchBtn" class="secondary-action-btn saved-search" title="Recherches sauvegardées">
                            <i class="bi bi-bookmark"></i>
                            <span>Sauvegardées</span>
                        </button>
                    </div>
                </div>
                
                <!-- Auto-completion intelligente -->
                <div id="searchSuggestions" class="search-suggestions-modern" style="display: none;">
                    <div class="suggestions-header">
                        <span class="suggestions-title">Suggestions</span>
                        <button class="close-suggestions">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>
                    <div class="suggestions-content">
                        <!-- Suggestions récentes -->
                        <div class="suggestion-section">
                            <div class="section-label">
                                <i class="bi bi-clock-history"></i>
                                <span>Recherches récentes</span>
                            </div>
                            <div class="suggestion-items" id="recentSearches">
                                <!-- Sera rempli dynamiquement -->
                            </div>
                        </div>
                        
                        <!-- Suggestions populaires -->
                        <div class="suggestion-section">
                            <div class="section-label">
                                <i class="bi bi-fire"></i>
                                <span>Recherches populaires</span>
                            </div>
                            <div class="suggestion-items" id="popularSearches">
                                <div class="suggestion-item popular">
                                    <div class="suggestion-content">
                                        <span class="suggestion-text">Vocabulaire anglais</span>
                                        <span class="suggestion-count">2.1k résultats</span>
                                    </div>
                                    <i class="bi bi-arrow-up-right"></i>
                                </div>
                                <div class="suggestion-item popular">
                                    <div class="suggestion-content">
                                        <span class="suggestion-text">Grammaire française</span>
                                        <span class="suggestion-count">1.8k résultats</span>
                                    </div>
                                    <i class="bi bi-arrow-up-right"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Smart suggestions -->
                        <div class="suggestion-section" id="smartSuggestions" style="display: none;">
                            <div class="section-label">
                                <i class="bi bi-stars"></i>
                                <span>Suggestions intelligentes</span>
                            </div>
                            <div class="suggestion-items" id="aiSuggestions">
                                <!-- IA suggestions basées sur le contexte -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notification Center -->
                <div id="notificationOverlay" class="notification-overlay"></div>
                <div id="notificationCenter" class="notification-center" style="display: none;">
                    <div class="notification-header">
                        <h6 class="mb-0">
                            <i class="bi bi-bell me-2"></i>
                            Notifications
                        </h6>
                        <div class="notification-actions">
                            <button class="btn-link-linguify btn-sm" title="Marquer tout comme lu">
                                <i class="bi bi-check2-all"></i>
                            </button>
                            <button class="btn-link-linguify btn-sm" title="Paramètres">
                                <i class="bi bi-gear"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="notification-filters">
                        <button class="notification-filter active" data-filter="all">
                            Toutes <span class="filter-count" id="allNotificationsCount">5</span>
                        </button>
                        <button class="notification-filter" data-filter="new-decks">
                            Nouveaux decks <span class="filter-count" id="newDecksCount">1</span>
                        </button>
                        <button class="notification-filter" data-filter="favorites-updates">
                            Favoris <span class="filter-count" id="favoritesUpdatesCount">1</span>
                        </button>
                        <button class="notification-filter" data-filter="collections-activity">
                            Collections <span class="filter-count" id="collectionsActivityCount">1</span>
                        </button>
                        <button class="notification-filter" data-filter="system">
                            Système <span class="filter-count" id="systemNotificationsCount">1</span>
                        </button>
                    </div>
                    
                    <div class="notification-list" id="notificationList">
                        <!-- Sample notifications for testing -->
                        <div class="notification-item" data-type="new-decks">
                            <div class="notification-icon new-deck">
                                <i class="bi bi-plus-circle"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-title">Nouveaux decks d'anglais disponibles</p>
                                <p class="notification-text">5 nouveaux decks de vocabulaire anglais ont été ajoutés par la communauté</p>
                                <small class="notification-time">2h</small>
                                <div class="notification-actions-item">
                                    <button class="notification-action-btn primary">Voir</button>
                                    <button class="notification-action-btn secondary">Ignorer</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="favorites-updates">
                            <div class="notification-icon favorite-update">
                                <i class="bi bi-heart-fill"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-title">Mise à jour d'un favori</p>
                                <p class="notification-text">Le deck "Vocabulaire Espagnol A2" a été mis à jour avec 20 nouvelles cartes</p>
                                <small class="notification-time">6h</small>
                                <div class="notification-actions-item">
                                    <button class="notification-action-btn primary">Voir</button>
                                    <button class="notification-action-btn secondary">Ignorer</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="collections-activity">
                            <div class="notification-icon collection-activity">
                                <i class="bi bi-collection"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-title">Activité dans vos collections</p>
                                <p class="notification-text">Un nouveau deck a été ajouté à votre collection "Langues Européennes"</p>
                                <small class="notification-time">12h</small>
                                <div class="notification-actions-item">
                                    <button class="notification-action-btn primary">Voir</button>
                                    <button class="notification-action-btn secondary">Ignorer</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="recommendations">
                            <div class="notification-icon recommendation">
                                <i class="bi bi-star-fill"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-title">Recommandation personnalisée</p>
                                <p class="notification-text">Basé sur votre activité, nous vous recommandons "Grammaire Française Avancée"</p>
                                <small class="notification-time">1j</small>
                                <div class="notification-actions-item">
                                    <button class="notification-action-btn primary">Voir</button>
                                    <button class="notification-action-btn secondary">Ignorer</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="system">
                            <div class="notification-icon system">
                                <i class="bi bi-gear-fill"></i>
                            </div>
                            <div class="notification-content">
                                <p class="notification-title">Nouvelles fonctionnalités</p>
                                <p class="notification-text">Découvrez les nouvelles options de recherche vocale et de filtres avancés</p>
                                <small class="notification-time">2j</small>
                                <div class="notification-actions-item">
                                    <button class="notification-action-btn primary">Voir</button>
                                    <button class="notification-action-btn secondary">Ignorer</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-footer">
                        <button class="btn-linguify btn-sm w-100">
                            Voir toutes les notifications
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Filtres actifs modernisés -->
            <div class="active-filters-display" id="activeFiltersDisplay" style="display: none;">
                <div class="filters-header">
                    <span class="filters-label">
                        <i class="bi bi-funnel"></i>
                        Filtres actifs
                    </span>
                    <button class="clear-all-filters" id="clearAllActiveFilters">
                        <i class="bi bi-x-circle"></i>
                        Tout effacer
                    </button>
                </div>
                <div class="active-filters-list" id="activeFiltersList">
                    <!-- Les filtres actifs apparaîtront ici dynamiquement -->
                </div>
            </div>
            
            <!-- Suggestions de recherche rapide -->
            <div class="quick-search-suggestions" id="quickSearchSuggestions">
                <div class="quick-suggestions-label">Recherches rapides :</div>
                <div class="quick-suggestions-list">
                    <button class="quick-suggestion" data-search="vocabulaire anglais">
                        <i class="bi bi-globe2"></i>
                        <span>Vocabulaire anglais</span>
                    </button>
                    <button class="quick-suggestion" data-search="mathématiques lycée">
                        <i class="bi bi-calculator"></i>
                        <span>Maths lycée</span>
                    </button>
                    <button class="quick-suggestion" data-search="histoire france">
                        <i class="bi bi-book"></i>
                        <span>Histoire de France</span>
                    </button>
                    <button class="quick-suggestion" data-search="sciences physiques">
                        <i class="bi bi-atom"></i>
                        <span>Sciences physiques</span>
                    </button>
                    <button class="quick-suggestion" data-search="informatique">
                        <i class="bi bi-laptop"></i>
                        <span>Informatique</span>
                    </button>
                </div>
            </div>
            
            <!-- Search history dropdown -->
            <div class="search-history" id="searchHistory" style="display: none;">
                <div class="history-header">
                    <small class="text-muted">Recherches récentes</small>
                    <button class="btn-link-linguify btn-sm" id="clearSearchHistory">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
                <div class="history-items">
                    <!-- Will be filled by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Header des résultats modernisé -->
        <div class="results-header-modern">
            <div class="results-info-section">
                <div class="results-title-group">
                    <h3 class="results-title">Résultats de recherche</h3>
                    <div class="results-count-display">
                        <span class="count-number" id="resultsCount">0</span>
                        <span class="count-text">deck(s) trouvé(s)</span>
                        <div class="search-time" id="searchTime" style="display: none;">
                            en <span class="time-value">0.2s</span>
                        </div>
                    </div>
                </div>
                <div class="search-query-display" id="currentQuery" style="display: none;">
                    Recherche pour : <strong id="queryText"></strong>
                    <button class="modify-search" id="modifySearch">
                        <i class="bi bi-pencil"></i>
                        Modifier
                    </button>
                </div>
            </div>
            
            <div class="results-controls-section">
                <!-- Contrôles de tri améliorés -->
                <div class="sort-controls">
                    <label class="sort-label">
                        <i class="bi bi-sort-down"></i>
                        Trier par :
                    </label>
                    <div class="sort-dropdown">
                        <select id="sortBy" class="modern-sort-select">
                            <option value="relevance" data-icon="bi-stars">🎯 Pertinence</option>
                            <option value="popularity" data-icon="bi-fire">🔥 Popularité</option>
                            <option value="rating" data-icon="bi-star-fill">⭐ Mieux notés</option>
                            <option value="created_at" data-icon="bi-clock">🆕 Plus récents</option>
                            <option value="name" data-icon="bi-alphabetical">📝 Alphabétique</option>
                            <option value="cards_count" data-icon="bi-stack">📚 Nb. de cartes</option>
                            <option value="downloads" data-icon="bi-download">⬇️ Plus téléchargés</option>
                        </select>
                    </div>
                    <button class="sort-order-toggle" id="sortOrder" title="Ordre croissant/décroissant">
                        <i class="bi bi-sort-up"></i>
                    </button>
                </div>
                
                <!-- Actions rapides -->
                <div class="results-actions">
                    <button class="action-btn save-search" id="saveCurrentSearch" title="Sauvegarder cette recherche">
                        <i class="bi bi-bookmark-plus"></i>
                    </button>
                    <button class="action-btn export-results" id="exportResults" title="Exporter les résultats">
                        <i class="bi bi-download"></i>
                    </button>
                    <button class="action-btn refresh-results" id="refreshResults" title="Actualiser">
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="study-content">
            <!-- Loading -->
            <div id="exploreLoading" class="text-center p-5" style="display: none;">
                <div class="spinner-linguify text-linguify-primary" role="status">
                    <span class="visually-hidden">Chargement...</span>
                </div>
                <p class="mt-3 text-muted">Recherche en cours...</p>
            </div>
            
            <!-- Grille des decks avec loading states -->
            <div class="decks-display-container">
                <!-- Loading skeleton -->
                <div id="loadingDecks" class="loading-skeleton-grid" style="display: none;">
                    <div class="skeleton-card" v-for="i in 6">
                        <div class="skeleton-header"></div>
                        <div class="skeleton-content">
                            <div class="skeleton-line"></div>
                            <div class="skeleton-line short"></div>
                        </div>
                        <div class="skeleton-footer"></div>
                    </div>
                </div>
                
                <!-- Grille principale -->
                <div id="publicDecksGrid" class="decks-grid-modern" data-view="grid">
                    <!-- Les cartes seront générées dynamiquement -->
                </div>
                
                <!-- Vue liste alternative -->
                <div id="publicDecksList" class="decks-list-modern" data-view="list" style="display: none;">
                    <!-- Vue liste des decks -->
                </div>
                
                <!-- Vue compacte -->
                <div id="publicDecksCompact" class="decks-compact-modern" data-view="compact" style="display: none;">
                    <!-- Vue compacte des decks -->
                </div>
            </div>
            
            <!-- États vides améliorés -->
            <div id="noResults" class="no-results-modern" style="display: none;">
                <div class="no-results-content">
                    <div class="no-results-icon">
                        <i class="bi bi-search"></i>
                    </div>
                    <h3 class="no-results-title">Aucun deck trouvé</h3>
                    <p class="no-results-description">
                        Nous n'avons trouvé aucun deck correspondant à vos critères.
                    </p>
                    
                    <div class="no-results-suggestions">
                        <div class="suggestions-title">Suggestions :</div>
                        <ul class="suggestions-list">
                            <li>Vérifiez l'orthographe de vos mots-clés</li>
                            <li>Utilisez des termes plus généraux</li>
                            <li>Réduisez le nombre de filtres actifs</li>
                            <li>Essayez une recherche dans une autre langue</li>
                        </ul>
                    </div>
                    
                    <div class="no-results-actions">
                        <button id="clearSearch" class="clear-search-btn">
                            <i class="bi bi-arrow-counterclockwise"></i>
                            <span>Effacer la recherche</span>
                        </button>
                        <button id="browsePopular" class="browse-popular-btn">
                            <i class="bi bi-fire"></i>
                            <span>Parcourir les populaires</span>
                        </button>
                        <button id="createDeck" class="create-deck-btn">
                            <i class="bi bi-plus-circle"></i>
                            <span>Créer votre propre deck</span>
                        </button>
                    </div>
                </div>
                
                <!-- Decks suggérés en cas de recherche vide -->
                <div class="suggested-decks" id="suggestedDecks">
                    <h4>Vous pourriez aimer :</h4>
                    <div class="suggested-decks-grid">
                        <!-- Suggestions basées sur les tendances -->
                    </div>
                </div>
            </div>
            
            <!-- Pagination modernisée -->
            <div id="explorePagination" class="pagination-container-modern">
                <div class="pagination-info">
                    <span class="showing-text">Affichage de</span>
                    <span class="range-start">1</span>-<span class="range-end">20</span>
                    <span class="total-text">sur</span>
                    <span class="total-results">156</span>
                    <span class="results-text">résultats</span>
                </div>
                <div class="pagination-controls">
                    <!-- Navigation par pages -->
                    <nav class="pagination-nav">
                        <button class="page-btn prev" disabled>
                            <i class="bi bi-chevron-left"></i>
                            <span>Précédent</span>
                        </button>
                        <div class="page-numbers">
                            <button class="page-number active">1</button>
                            <button class="page-number">2</button>
                            <button class="page-number">3</button>
                            <span class="page-separator">...</span>
                            <button class="page-number">8</button>
                        </div>
                        <button class="page-btn next">
                            <span>Suivant</span>
                            <i class="bi bi-chevron-right"></i>
                        </button>
                    </nav>
                    
                    <!-- Options d'affichage -->
                    <div class="results-per-page">
                        <label>Résultats par page :</label>
                        <select id="resultsPerPage">
                            <option value="10">10</option>
                            <option value="20" selected>20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
                
                <!-- Scroll infini toggle -->
                <div class="infinite-scroll-toggle">
                    <label class="toggle-switch">
                        <input type="checkbox" id="infiniteScroll">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label">Défilement infini</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Détails d'un deck public -->
    <div id="publicDeckDetails" style="display: none;">
        <div class="study-header">
            <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center gap-2">
                    <button id="backToResults" class="btn-linguify-secondary btn-sm">
                        <i class="bi bi-arrow-left"></i>
                    </button>
                    <div>
                        <h4 id="publicDeckName" class="mb-0">Nom du deck</h4>
                        <small id="publicDeckAuthor" class="text-muted">Par @username</small>
                    </div>
                </div>
                
                <div class="d-flex align-items-center gap-2">
                    <span id="publicDeckStats" class="badge-linguify"></span>
                    <button id="importPublicDeck" class="btn-linguify btn-sm">
                        <i class="bi bi-download me-1"></i>
                        Importer ce deck
                    </button>
                </div>
            </div>
        </div>
        
        <div class="study-content">
            <div class="p-4">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card-linguify">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-card-list me-2"></i>
                                    Aperçu des cartes
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="publicDeckCardsPreview">
                                    <!-- Sera rempli par JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card-linguify">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-info-circle me-2"></i>
                                    Informations
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="publicDeckInfo">
                                    <!-- Sera rempli par JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Rating & Reviews Section -->
                        <div class="card-linguify mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-star me-2"></i>
                                    Évaluations & Avis
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="deckRatingSection">
                                    <!-- Interactive rating -->
                                    <div class="rating-section mb-3">
                                        <div class="d-flex align-items-center gap-2 mb-2">
                                            <span class="small fw-bold">Votre note :</span>
                                            <div id="userRatingStars" class="interactive-rating">
                                                <i class="bi bi-star rating-star" data-rating="1"></i>
                                                <i class="bi bi-star rating-star" data-rating="2"></i>
                                                <i class="bi bi-star rating-star" data-rating="3"></i>
                                                <i class="bi bi-star rating-star" data-rating="4"></i>
                                                <i class="bi bi-star rating-star" data-rating="5"></i>
                                            </div>
                                        </div>
                                        <div class="rating-summary" id="ratingSummary">
                                            <!-- Sera rempli par JavaScript -->
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Reviews List -->
                                <div id="reviewsList" class="mt-3">
                                    <!-- Sera rempli par JavaScript -->
                                </div>
                                
                                <div class="text-center mt-3">
                                    <button class="btn-linguify-secondary btn-sm" id="loadMoreReviews">
                                        <i class="bi bi-arrow-down-circle me-1"></i>
                                        Voir plus d'avis
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Author Profile Section -->
                        <div class="card-linguify mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-person-circle me-2"></i>
                                    Profil de l'auteur
                                </h6>
                            </div>
                            <div class="card-body">
                                <div id="authorProfile">
                                    <!-- Sera rempli par JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal d'importation -->
<div class="modal-overlay" id="importModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-primary">
                        <i class="bi bi-download text-linguify-primary text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title">Importer un deck public</h3>
                        <p class="modal-subtitle">Ajouter ce deck à votre collection</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Nom du deck dans votre collection</label>
                    <input type="text" id="importDeckName" class="form-control-linguify" 
                           placeholder="Nom personnalisé (optionnel)">
                    <div class="form-text">
                        Si vide, le nom original sera utilisé avec "(Copie)" ajouté.
                    </div>
                </div>
                
                <div class="alert-box alert-primary">
                    <div class="alert-content">
                        <div class="alert-icon">
                            <i class="bi bi-info-circle-fill text-linguify-primary text-lg"></i>
                        </div>
                        <div>
                            <h4 class="text-sm font-medium text-linguify-primary-dark">Information</h4>
                            <p class="mt-1 text-sm text-linguify-primary">Une copie complète du deck sera créée dans votre collection personnelle. Vous pourrez la modifier librement sans affecter le deck original.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Annuler
                </button>
                <button type="button" id="confirmImportDeck" class="btn-linguify">
                    <i class="bi bi-download"></i>Importer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de création de collection -->
<div class="modal-overlay" id="createCollectionModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-accent">
                        <i class="bi bi-heart text-linguify-accent text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title">Nouvelle Collection</h3>
                        <p class="modal-subtitle">Organisez vos decks favoris</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Nom de la collection</label>
                    <input type="text" id="collectionName" class="form-control-linguify" 
                           placeholder="Ex: Vocabulaire Anglais, Sciences Niveau 3...">
                </div>
                <div class="mb-3">
                    <label class="form-label">Description (optionnelle)</label>
                    <textarea id="collectionDescription" class="form-control-linguify" rows="2"
                              placeholder="Décrivez brièvement cette collection..."></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Visibilité</label>
                    <div class="form-check-linguify">
                        <input class="form-check-input-linguify" type="radio" name="visibility" id="privateCollection" value="private" checked>
                        <label class="form-check-label-linguify" for="privateCollection">
                            <i class="bi bi-lock me-1"></i>Privée (seulement moi)
                        </label>
                    </div>
                    <div class="form-check-linguify">
                        <input class="form-check-input-linguify" type="radio" name="visibility" id="publicCollection" value="public">
                        <label class="form-check-label-linguify" for="publicCollection">
                            <i class="bi bi-globe me-1"></i>Publique (visible par tous)
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Annuler
                </button>
                <button type="button" id="createCollectionConfirm" class="btn-linguify">
                    <i class="bi bi-plus"></i>Créer la collection
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal d'ajout à une collection -->
<div class="modal-overlay" id="addToCollectionModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-success">
                        <i class="bi bi-plus-circle text-linguify-success text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title">Ajouter à une collection</h3>
                        <p class="modal-subtitle">Organisez vos decks préférés</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="selectedDeckInfo" class="mb-3">
                    <!-- Infos du deck sélectionné -->
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Sélectionner une collection</label>
                    <div id="collectionsList" class="collections-list">
                        <!-- Sera rempli par JavaScript -->
                    </div>
                </div>
                
                <div class="text-center">
                    <button type="button" class="btn-linguify-secondary btn-sm" id="createNewCollectionFromModal">
                        <i class="bi bi-plus me-1"></i>Créer une nouvelle collection
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Annuler
                </button>
                <button type="button" id="addToCollectionConfirm" class="btn-linguify" disabled>
                    <i class="bi bi-check"></i>Ajouter
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de gestion des collections -->
<div class="modal-overlay" id="manageCollectionModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-gray">
                        <i class="bi bi-gear text-gray-600 text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title" id="manageCollectionTitle">Gérer la collection</h3>
                        <p class="modal-subtitle">Modifier et organiser</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="collection-info">
                            <h6>Informations de la collection</h6>
                            <div class="mb-3">
                                <label class="form-label small">Nom</label>
                                <input type="text" id="editCollectionName" class="form-control-linguify form-control-sm">
                            </div>
                            <div class="mb-3">
                                <label class="form-label small">Description</label>
                                <textarea id="editCollectionDescription" class="form-control-linguify form-control-sm" rows="2"></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label small">Visibilité</label>
                                <select id="editCollectionVisibility" class="form-select-linguify form-select-sm">
                                    <option value="private">🔒 Privée</option>
                                    <option value="public">🌐 Publique</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="collection-decks">
                            <h6>Decks dans cette collection <span id="collectionDeckCount" class="badge-linguify">0</span></h6>
                            <div id="collectionDecksList" class="collection-decks-list">
                                <!-- Sera rempli par JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-danger" id="deleteCollectionBtn">
                    <i class="bi bi-trash"></i>Supprimer la collection
                </button>
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Fermer
                </button>
                <button type="button" id="saveCollectionChanges" class="btn-linguify">
                    <i class="bi bi-check"></i>Sauvegarder
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de paramètres de notifications -->
<div class="modal-overlay" id="notificationSettingsModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-primary">
                        <i class="bi bi-bell-fill text-linguify-primary text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title">Paramètres des notifications</h3>
                        <p class="modal-subtitle">Personnalisez vos alertes</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-toggles me-2"></i>
                        Préférences générales
                    </h6>
                    
                    <div class="form-check-linguify form-switch mb-3">
                        <input class="form-check-input-linguify" type="checkbox" id="enableNotifications" checked>
                        <label class="form-check-label-linguify" for="enableNotifications">
                            Activer toutes les notifications
                        </label>
                    </div>
                    
                    <div class="form-check-linguify form-switch mb-3">
                        <input class="form-check-input-linguify" type="checkbox" id="enableSoundNotifications">
                        <label class="form-check-label-linguify" for="enableSoundNotifications">
                            Sons de notification
                        </label>
                    </div>
                    
                    <div class="form-check-linguify form-switch mb-3">
                        <input class="form-check-input-linguify" type="checkbox" id="enableBadgeNotifications" checked>
                        <label class="form-check-label-linguify" for="enableBadgeNotifications">
                            Badge de compteur
                        </label>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-funnel me-2"></i>
                        Types de notifications
                    </h6>
                    
                    <div class="notification-type-setting mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <label class="form-check-label-linguify fw-medium">
                                    <i class="bi bi-plus-circle me-2 text-linguify-success"></i>
                                    Nouveaux decks publics
                                </label>
                                <small class="d-block text-muted">Alertes pour les nouveaux decks ajoutés</small>
                            </div>
                            <div class="form-check-linguify form-switch">
                                <input class="form-check-input-linguify" type="checkbox" id="notifyNewDecks" checked>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-type-setting mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <label class="form-check-label-linguify fw-medium">
                                    <i class="bi bi-heart me-2 text-danger"></i>
                                    Mises à jour des favoris
                                </label>
                                <small class="d-block text-muted">Modifications de vos decks favoris</small>
                            </div>
                            <div class="form-check-linguify form-switch">
                                <input class="form-check-input-linguify" type="checkbox" id="notifyFavoritesUpdates" checked>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-type-setting mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <label class="form-check-label-linguify fw-medium">
                                    <i class="bi bi-collection me-2 text-linguify-primary"></i>
                                    Activité des collections
                                </label>
                                <small class="d-block text-muted">Nouveaux decks dans vos collections suivies</small>
                            </div>
                            <div class="form-check-linguify form-switch">
                                <input class="form-check-input-linguify" type="checkbox" id="notifyCollectionsActivity" checked>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-type-setting mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <label class="form-check-label-linguify fw-medium">
                                    <i class="bi bi-star me-2 text-warning"></i>
                                    Recommandations intelligentes
                                </label>
                                <small class="d-block text-muted">Suggestions personnalisées</small>
                            </div>
                            <div class="form-check-linguify form-switch">
                                <input class="form-check-input-linguify" type="checkbox" id="notifyRecommendations" checked>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-type-setting mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <label class="form-check-label-linguify fw-medium">
                                    <i class="bi bi-gear me-2 text-linguify-secondary"></i>
                                    Notifications système
                                </label>
                                <small class="d-block text-muted">Mises à jour et maintenance</small>
                            </div>
                            <div class="form-check-linguify form-switch">
                                <input class="form-check-input-linguify" type="checkbox" id="notifySystem">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6 class="fw-bold mb-3">
                        <i class="bi bi-clock me-2"></i>
                        Fréquence des notifications
                    </h6>
                    
                    <select id="notificationFrequency" class="form-select-linguify">
                        <option value="realtime">En temps réel</option>
                        <option value="hourly">Toutes les heures</option>
                        <option value="daily" selected>Quotidienne</option>
                        <option value="weekly">Hebdomadaire</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Annuler
                </button>
                <button type="button" class="btn-linguify" id="saveNotificationSettingsBtn">
                    <i class="bi bi-check-lg"></i>Sauvegarder
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal pour toutes les notifications -->
<div class="modal-overlay" id="allNotificationsModal" aria-hidden="true">
    <div class="modal-backdrop">
        <div class="modal-overlay-bg" aria-hidden="true"></div>
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <div class="modal-header-content">
                    <div class="modal-icon modal-icon-primary">
                        <i class="bi bi-bell-fill text-linguify-primary text-xl"></i>
                    </div>
                    <div>
                        <h3 class="modal-title">Toutes les notifications</h3>
                        <p class="modal-subtitle">Historique complet</p>
                    </div>
                </div>
                <button type="button" class="modal-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="notification-full-list" id="notificationFullList">
                    <!-- All notifications will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-linguify-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle"></i>Fermer
                </button>
                <button type="button" class="btn-linguify" id="markAllNotificationsReadBtn">
                    <i class="bi bi-check2-all"></i>Marquer tout comme lu
                </button>
            </div>
        </div>
    </div> <!-- End flex container -->
</div>

<!-- Sidebar Overlay -->
<div id="sidebarOverlay" class="sidebar-overlay" style="display: none;"></div>

{% endblock %}

{% block extra_js %}
<!-- Explorer Core Scripts -->
<!-- 1. Utilities first (Service Worker, Performance, Error Tracking) -->
<script src="{% static 'revision/js/explorer/utils.js' %}?v=20250823"></script>

<!-- 2. Main Explorer functionality -->
<script src="{% static 'revision/js/explorer/main.js' %}?v=20250111-optimized"></script>

<!-- 3. Page-specific functionality (Notifications, UI interactions) -->
<script src="{% static 'revision/js/explorer/explore.js' %}?v=20250823"></script>

<!-- 4. Development tools -->
{% if debug or request.GET.test %}
<script src="{% static 'revision/js/explorer/test-suite.js' %}"></script>
{% endif %}
{% endblock %}