<!-- Interface unifiée Linguify -->
<div class="navbar-linguify">
    <!-- Gauche: Navigation + Actions principales -->
    <div class="navbar-section">
        <!-- Bouton toggle sidebar pour toutes les pages -->
        <div>
            <button id="toggleSidebar" 
                class="btn-navbar-outline" 
                title="Masquer/Afficher la barre latérale"
                aria-label="Basculer la barre latérale"
                aria-expanded="true">
            <i class="bi bi-layout-sidebar-inset" aria-hidden="true"></i>
            </button>
        </div>
        
        <!-- Navigation tabs -->
        <div class="nav-tabs-group">
            <a href="{% url 'revision_web:main' %}" 
               class="nav-tab {% if app_name == 'revision' and not study_mode and not view_type %}active{% endif %}">
                <i class="bi bi-stack"></i>
                Liste de cartes
            </a>
            <a href="/revision/explore/" 
               class="nav-tab {% if view_type == 'explore' %}active{% endif %}">
                <i class="bi bi-globe2"></i>
                Explorer
            </a>
            <a href="{% url 'revision_web:stats_dashboard' %}" 
               class="nav-tab {% if view_type == 'stats' %}active{% endif %}">
                <i class="bi bi-graph-up"></i>
                Statistiques
            </a>
        </div>

        <!-- Refresh - Always show, universal for all views -->
        <div class="container-extra">
            {% if view_type == 'stats' %}
            <button class="btn-sb" title="Actualiser les statistiques"
                    hx-get="{% url 'revision_web:stats_dashboard' %}"
                    hx-target="body"
                    hx-indicator=".htmx-indicator">
                <i class="bi bi-arrow-clockwise"></i>
                <span class="d-none d-xl-inline"></span>
            </button>
            {% elif view_type == 'explore' %}
            <button class="btn-sb" title="Actualiser les résultats"
                    hx-get="/revision/explore/"
                    hx-target="#exploreResults"
                    hx-indicator=".htmx-indicator">
                <i class="bi bi-arrow-clockwise"></i>
                <span class="d-none d-xl-inline"></span>
            </button>
            {% else %}
            <button class="btn-sb" title="Actualiser la liste"
                    hx-get="{% url 'revision_web:main' %}"
                    hx-target="#deckList"
                    hx-indicator=".htmx-indicator">
                <i class="bi bi-arrow-clockwise"></i>
                <span class="d-none d-xl-inline"></span>
            </button>
            {% endif %}
        </div>

    </div>
    
    <!-- Droite: Actions et filtres contextuels -->
    <div class="navbar-section-right">
        {% if view_type == 'stats' %}
        <!-- Filtres pour la page Statistiques - Simplifiés -->
        <!-- Time Range Filter - Spécifique aux statistiques -->
        <select id="statsTimeRange" class="form-select-linguify" style="width: 140px; min-width: 120px;">
            <option value="7">7 derniers jours</option>
            <option value="30" selected>30 derniers jours</option>
            <option value="90">3 derniers mois</option>
            <option value="365">Cette année</option>
            <option value="all">Toute la période</option>
        </select>
        
        <button id="exportStats" class="btn-navbar btn-navbar-outline" title="Exporter les statistiques">
            <i class="bi bi-download"></i>
            <span class="d-none d-lg-inline">Exporter</span>
        </button>
        
        {% elif view_type == 'explore' %}
        <!-- Bouton toggle sidebar pour Explorer -->
        <button id="toggleSidebar" class="btn-navbar btn-navbar-outline" onclick="toggleSidebar()">
            <i class="bi bi-layout-sidebar"></i>
            <span class="d-none d-lg-inline">Filtres</span>
        </button>
        
        <!-- Filtres pour la page Explorer - Alignés avec la Liste de cartes -->
        <input type="text" id="searchInput" class="form-control-linguify" placeholder="Rechercher..." style="width: 140px; min-width: 100px;">
        
        <!-- Status Filter Dropdown -->
        <div class="dropdown">
            <button id="statusFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="statusFilterText">Tous les statuts</span>
            </button>
            <ul id="statusFilterDropdown" class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('', 'Tous les statuts')">Tous les statuts</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('new', 'Récents')">Récents</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('popular', 'Populaires')">Populaires</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('public', 'Publics')">Publics</a></li>
            </ul>
        </div>
        
        <!-- Sort Filter Dropdown -->
        <div class="dropdown">
            <button id="sortFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="sortFilterText">Plus récents</span>
            </button>
            <ul id="sortFilterDropdown" class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('updated_desc', 'Plus récents')">Plus récents</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('name_asc', 'A-Z')">A-Z</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('popularity_desc', 'Popularité')">Popularité</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('cards_desc', 'Nb. cartes')">Nb. cartes</a></li>
            </ul>
        </div>
        
        <!-- Tags Filter Dropdown -->
        <div class="dropdown">
            <button id="tagsFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="tagsFilterText">Tous les tags</span>
            </button>
            <ul id="tagsFilterDropdown" class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="selectTagsFilter('', 'Tous les tags')">Tous les tags</a></li>
                <!-- More tags will be dynamically loaded here -->
            </ul>
        </div>
        
        {% else %}
        <!-- Filtres pour les pages personnelles -->
        <input type="text" id="searchInput" class="form-control-linguify" placeholder="Rechercher..." style="width: 140px; min-width: 100px;">
        
        <!-- Status Filter Dropdown -->
        <div class="dropdown">
            <button id="statusFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="statusFilterText">Tous les statuts</span>
            </button>
            <ul id="statusFilterDropdown" class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('', 'Tous les statuts')">Tous les statuts</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('active', 'Actifs')">Actifs</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('archived', 'Archivés')">Archivés</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectStatusFilter('public', 'Publics')">Publics</a></li>
            </ul>
        </div>
        
        <!-- Sort Filter Dropdown -->
        <div class="dropdown">
            <button id="sortFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="sortFilterText">Plus récents</span>
            </button>
            <ul id="sortFilterDropdown" class="dropdown-menu">
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('updated_desc', 'Plus récents')">Plus récents</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('name_asc', 'A-Z')">A-Z</a></li>
                <li><a class="dropdown-item" href="#" onclick="selectSortFilter('progress_desc', 'Progression')">Progression</a></li>
            </ul>
        </div>
        
        <!-- Tags Filter Dropdown -->
        <div class="dropdown">
            <button id="tagsFilterToggle" class="btn btn-outline-linguify dropdown-toggle" style="width: 110px; min-width: 90px;" data-bs-toggle="dropdown">
                <span id="tagsFilterText">Tous les tags</span>
            </button>
            <ul id="tagsFilterDropdown" class="dropdown-menu">
                <!-- Tags will be dynamically loaded here -->
            </ul>
        </div>
        
        <!-- Actions - Only show when no deck is selected -->
        <div id="generalActions" class="navbar-actions-group">
            <button id="importDeck" class="btn-navbar btn-navbar-outline">
                <i class="bi bi-upload"></i>
                <span class="d-none d-xxl-inline">Importer</span>
            </button>
            
            <button id="createDeck" class="btn-navbar btn-navbar-primary">
                <i class="bi bi-plus-lg"></i>
                <span class="d-none d-xxl-inline">Nouveau</span>
            </button>
        </div>
        {% endif %}
    </div>
</div>