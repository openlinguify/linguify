{% extends "saas_web/base.html" %}
{% load static %}

{% block title %}Language Learning - OpenLinguify{% endblock %}

{% block content %}
<!-- DonnÃ©es pour l'application Language Learning -->
<script id="language-learning-data" type="application/json">
{
    "selectedLanguage": "{{ selected_language }}",
    "selectedLanguageName": "{{ selected_language_name }}",
    "courseUnits": {{ course_units|safe }},
    "activeUnit": {{ active_unit|safe }},
    "activeUnitModules": {{ active_unit_modules|safe }},
    "userStreak": {{ user_streak }},
    "viewType": "{{ view_type }}"
}
</script>

<!-- Language Learning App with HTMX + Alpine.js -->
<div id="language-learning-app" class="language-learning-app" x-data="learningDashboard()">

    <!-- Learning Navbar -->
    <div class="learning-navbar">
        <div class="container">
            <a href="{% url 'language_learning:learning_interface' %}" class="navbar-brand">
                <i class="bi bi-book me-2"></i>Language Learning
            </a>

            <div class="navbar-actions">
                <!-- Language Selector -->
                <div class="language-selector">
                    <label class="text-white-50 me-2">Learning:</label>
                    <select x-model="selectedLanguage" @change="selectLanguage($event.target.value)" class="form-select form-select-sm">
                        <option value="EN" {% if selected_language == 'EN' %}selected{% endif %}>ðŸ‡¬ðŸ‡§ English</option>
                        <option value="FR" {% if selected_language == 'FR' %}selected{% endif %}>ðŸ‡«ðŸ‡· FranÃ§ais</option>
                        <option value="ES" {% if selected_language == 'ES' %}selected{% endif %}>ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
                        <option value="DE" {% if selected_language == 'DE' %}selected{% endif %}>ðŸ‡©ðŸ‡ª Deutsch</option>
                    </select>
                </div>

                <!-- Streak Display -->
                <div class="streak-display">
                    <i class="bi bi-fire text-warning"></i>
                    <span x-text="userStreak"></span>
                    <span class="d-none d-lg-inline">day streak</span>
                    <span x-text="getStreakIcon(userStreak)"></span>
                </div>

                <!-- Settings Link -->
                <a href="/settings/language_learning/" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-gear"></i>
                    <span class="d-none d-lg-inline ms-1">Settings</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
        <div id="learning-content"
             hx-get="{% url 'language_learning:learning_interface' %}"
             hx-trigger="load"
             hx-target="#learning-content"
             class="fade-in">

            <!-- Initial loading state -->
            <div class="loading">
                <div class="spinner"></div>
            </div>

        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<!-- Learning styles -->
<link rel="stylesheet" href="{% static 'language_learning/css/learning.css' %}">
{% endblock %}

{% block extra_js %}
<!-- HTMX -->
<script src="https://unpkg.com/htmx.org@1.9.10"></script>
<!-- Alpine.js -->
<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
<!-- Learning JavaScript -->
<script src="{% static 'language_learning/js/learning.js' %}"></script>
{% endblock %}