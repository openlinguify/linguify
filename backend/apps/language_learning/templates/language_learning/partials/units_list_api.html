<!-- Units List - API Version -->
<div x-show="!activeUnit" x-transition class="fade-in">
    <!-- Loading State -->
    <div x-show="loading" class="text-center p-4">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Chargement...</span>
        </div>
        <p class="mt-2 text-muted">Chargement des unités...</p>
    </div>

    <!-- Units Grid -->
    <div x-show="!loading && courseUnits.length > 0" class="row">
        <template x-for="unit in courseUnits" :key="unit.id">
            <div class="col-md-6 mb-4">
                <div x-data="unitCard(unit, $data)"
                     class="unit-card card h-100"
                     :class="{ 'completed': unit.progress_percentage === 100 }"
                     @click="selectUnit()">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="unit-icon me-3" :style="'background-color: ' + unit.color">
                                <span x-text="unit.icon" class="fs-3"></span>
                            </div>
                            <div class="flex-grow-1">
                                <h5 class="card-title mb-1" x-text="unit.title"></h5>
                                <p class="card-text text-muted small mb-2" x-text="unit.description"></p>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="badge bg-light text-dark">
                                        Unité <span x-text="unit.unit_number"></span>
                                    </span>
                                    <span class="badge bg-primary">
                                        <span x-text="unit.completed_modules"></span>/<span x-text="unit.modules_count"></span> modules
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Bar -->
                        <div class="mb-2">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <small class="text-muted">Progression</small>
                                <small class="text-muted">
                                    <span x-text="unit.progress_percentage"></span>%
                                </small>
                            </div>
                            <div class="unit-progress">
                                <div class="progress-bar"
                                     :class="progressClass"
                                     :style="'width: ' + progressWidth"></div>
                            </div>
                        </div>

                        <!-- Action Button -->
                        <div class="text-end">
                            <template x-if="unit.progress_percentage === 100">
                                <span class="text-success">
                                    <i class="bi bi-check-circle-fill me-1"></i>
                                    Terminé
                                </span>
                            </template>
                            <template x-if="unit.progress_percentage < 100">
                                <button class="btn btn-outline-primary btn-sm">
                                    <i class="bi bi-play-circle me-1"></i>
                                    <span x-text="unit.progress_percentage > 0 ? 'Continuer' : 'Commencer'"></span>
                                </button>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <!-- Empty State -->
    <div x-show="!loading && courseUnits.length === 0" class="text-center p-4">
        <i class="bi bi-collection text-muted fs-1"></i>
        <p class="text-muted mt-2">Aucune unité de cours disponible pour cette langue.</p>
    </div>
</div>