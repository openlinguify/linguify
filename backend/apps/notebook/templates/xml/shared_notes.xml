<?xml version="1.0" encoding="utf-8"?>
<linguify>
    <data>
        <!-- Vue formulaire pour les notes partag√©es -->
        <record id="shared_note_form_view" model="ir.ui.view">
            <field name="name">shared.note.form</field>
            <field name="model">notebook.sharednote</field>
            <field name="arch" type="xml">
                <form string="Note Partag√©e">
                    <header>
                        <field name="can_edit" widget="statusbar" statusbar_visible="false,true"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="note" options="{'no_create': True}"/>
                            </h1>
                        </div>

                        <group>
                            <group string="Partage">
                                <field name="shared_with"/>
                                <field name="shared_at"/>
                                <field name="can_edit"/>
                            </group>
                            <group string="Permissions">
                                <field name="note_title" string="Titre de la note"/>
                                <field name="note_owner" string="Propri√©taire"/>
                                <field name="note_category" string="Cat√©gorie"/>
                            </group>
                        </group>

                        <notebook>
                            <page string="Contenu de la note">
                                <group>
                                    <field name="note_content" string="Contenu" readonly="1"/>
                                    <field name="note_language" string="Langue" readonly="1"/>
                                    <field name="note_type" string="Type" readonly="1"/>
                                </group>
                            </page>

                            <page string="Historique des modifications" attrs="{'invisible': [('can_edit', '=', False)]}">
                                <field name="modification_history" widget="text" readonly="1"/>
                            </page>

                            <page string="Commentaires">
                                <field name="comments" widget="text" placeholder="Ajoutez vos commentaires sur cette note partag√©e..."/>
                            </page>
                        </notebook>
                    </sheet>

                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Vue liste pour les notes partag√©es -->
        <record id="shared_note_tree_view" model="ir.ui.view">
            <field name="name">shared.note.tree</field>
            <field name="model">notebook.sharednote</field>
            <field name="arch" type="xml">
                <tree string="Notes Partag√©es" decoration-info="can_edit==True">
                    <field name="note"/>
                    <field name="shared_with"/>
                    <field name="shared_at"/>
                    <field name="can_edit"/>
                    <field name="note_owner" string="Propri√©taire"/>
                    <field name="note_type" string="Type"/>
                    <field name="note_language" string="Langue"/>
                </tree>
            </field>
        </record>

        <!-- Vue kanban pour les notes partag√©es -->
        <record id="shared_note_kanban_view" model="ir.ui.view">
            <field name="name">shared.note.kanban</field>
            <field name="model">notebook.sharednote</field>
            <field name="arch" type="xml">
                <kanban default_group_by="can_edit">
                    <field name="note"/>
                    <field name="shared_with"/>
                    <field name="shared_at"/>
                    <field name="can_edit"/>
                    <field name="note_title"/>
                    <field name="note_owner"/>
                    <field name="note_content"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_card" t-attf-class="#{record.can_edit.raw_value ? 'oe_kanban_color_5' : 'oe_kanban_color_0'}">
                                <div class="oe_kanban_content">
                                    <div class="oe_kanban_title">
                                        <strong><field name="note_title"/></strong>
                                        <t t-if="record.can_edit.raw_value">‚úèÔ∏è</t>
                                        <t t-else="">üëÅÔ∏è</t>
                                    </div>
                                    <div class="oe_kanban_details">
                                        <div><strong>Partag√© avec:</strong> <field name="shared_with"/></div>
                                        <div><strong>Propri√©taire:</strong> <field name="note_owner"/></div>
                                        <div class="oe_kanban_content_preview">
                                            <field name="note_content"/>
                                        </div>
                                    </div>
                                    <div class="oe_kanban_bottom">
                                        <div class="oe_kanban_bottom_left">
                                            Partag√© le: <field name="shared_at"/>
                                        </div>
                                        <div class="oe_kanban_bottom_right">
                                            <t t-if="record.can_edit.raw_value">
                                                <span class="badge badge-success">√âdition</span>
                                            </t>
                                            <t t-else="">
                                                <span class="badge badge-info">Lecture</span>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Vue de recherche pour les notes partag√©es -->
        <record id="shared_note_search_view" model="ir.ui.view">
            <field name="name">shared.note.search</field>
            <field name="model">notebook.sharednote</field>
            <field name="arch" type="xml">
                <search string="Rechercher Notes Partag√©es">
                    <field name="note"/>
                    <field name="shared_with"/>
                    <field name="note_owner"/>
                    <field name="note_content"/>

                    <!-- Filtres -->
                    <filter string="Mes partages" domain="[('note.user', '=', uid)]"/>
                    <filter string="Partag√©es avec moi" domain="[('shared_with', '=', uid)]"/>
                    <filter string="√âdition autoris√©e" domain="[('can_edit', '=', True)]"/>
                    <filter string="Lecture seule" domain="[('can_edit', '=', False)]"/>

                    <separator/>

                    <!-- Filtres par date -->
                    <filter string="Partag√© aujourd'hui" domain="[('shared_at', '>=', datetime.datetime.now().strftime('%Y-%m-%d 00:00:00'))]"/>
                    <filter string="Partag√© cette semaine" domain="[('shared_at', '>=', (datetime.datetime.now() - datetime.timedelta(weeks=1)).strftime('%Y-%m-%d 00:00:00'))]"/>

                    <separator/>

                    <!-- Groupements -->
                    <group expand="0" string="Grouper par">
                        <filter string="Permissions" context="{'group_by': 'can_edit'}"/>
                        <filter string="Partag√© avec" context="{'group_by': 'shared_with'}"/>
                        <filter string="Propri√©taire" context="{'group_by': 'note.user'}"/>
                        <filter string="Type de note" context="{'group_by': 'note.note_type'}"/>
                        <filter string="Date de partage" context="{'group_by': 'shared_at:month'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Vue graphique pour les statistiques de partage -->
        <record id="shared_note_graph_view" model="ir.ui.view">
            <field name="name">shared.note.graph</field>
            <field name="model">notebook.sharednote</field>
            <field name="arch" type="xml">
                <graph string="Statistiques Partage" type="pie">
                    <field name="can_edit" type="row"/>
                    <field name="shared_at" type="col" interval="month"/>
                </graph>
            </field>
        </record>
    </data>
</linguify>